<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Submission Form</title>
    <link rel="stylesheet" href="./css/upload_doc.css">
    <!-- Add PDF.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        // Initialize PDF.js worker
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
</head>
<body>
    <div id="side-bar"></div>
    <div id="navbar-header"></div>

    <div class="main-content">
        <div class="container">
            <div class="left-panel">
                <h2>Add New Document</h2>
                <form id="upload-form" method="POST" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="title">Title</label>
                        <input type="text" id="title" name="title" required placeholder="Enter document title">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="authorInput">Author</label>
                            <div class="dropdown">
                                <input type="text" id="authorInput" name="authorInput" placeholder="Type to search authors...">
                                <div class="dropdown-list" id="authorList"></div>
                            </div>
                            <div class="select-container">
                                <div class="selected-authors" id="selectedAuthors"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="publication_date">Publication Date</label>
                            <input type="date" id="publication_date" name="publication_date" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="volume-no">Volume</label>
                        <input type="text" id="volume-no" name="volume-no" required placeholder="Enter volume number">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="topicInput">Topic</label>
                            <div class="dropdown">
                                <input type="text" id="topicInput" name="topicInput" placeholder="Type to search topics...">
                                <div class="dropdown-list" id="topicList"></div>
                            </div>
                            <div class="select-container">
                                <div class="selected-topics" id="selectedTopics"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="category">Category</label>
                            <select id="category" name="category" required>
                                <option value="default">Select Category</option>
                                <option value="thesis">Thesis</option>
                                <option value="dissertation">Dissertation</option>
                                <option value="confluence">Confluence</option>
                                <option value="synergy">Synergy</option>
                            </select>
                        </div>
                    </div>

                    <div class="upload-icons-container">
                        <label for="file" class="upload-file">
                            <div class="upload-box">
                                <!-- SVG for File Upload -->
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-paperclip"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 7l-6.5 6.5a1.5 1.5 0 0 0 3 3l6.5 -6.5a3 3 0 0 0 -6 -6l-6.5 6.5a4.5 4.5 0 0 0 9 9l6.5 -6.5" /></svg>
                                <p>Attach File</p>
                            </div>
                            <input type="file" id="file" name="file" accept=".pdf" style="display: none;" required>
                        </label>
                    </div>
                    
                    <div class="submit-container">
                        <button type="submit">SUBMIT</button>
                    </div>
                </form>
            </div>
            <div class="right-panel">
                <div class="preview-header">
                    <h2>Preview</h2>
                </div>
                <div class="preview-content">
                    <div class="preview-header-content">
                        <img id="category-icon" src="icons/Category-icons/default_category_icon.png" alt="Category Icon" class="category-icon">
                        <div class="title-author-container">
                            <p><strong id="preview-title">Title of Document</strong></p>
                            <p id="preview-author">by Author Name</p>
                        </div>
                    </div>
                    
                    <p id="preview-year">Publishing Date: 2021</p>
                    <p id="preview-topic">Topics: History</p>
                    
                    <p id="preview-pages">Pages: <span id="page-count">0</span></p>
                    <p id="preview-added-date">Added Date: January 15, 2021</p>

                    <div class="read-document-container">
                        <button id="read-document" class="disabled-button" disabled>Read Document</button>
                    </div>

                    <div class="abstract-preview">
                        <p><strong>Abstract</strong></p>
                        <div class="abstract-content">
                            <p id="preview-abstract">Abstract will be extracted from the PDF file.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Popup Modal -->
    <div id="success-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">
                <path fill="#4caf50" d="M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"></path>
                <path fill="#ccff90" d="M34.602,14.602L21,28.199l-5.602-5.598l-2.797,2.797L21,33.801l16.398-16.402L34.602,14.602z"></path>
            </svg>
            <h2>Uploaded successfully!</h2>
            <p>Your document has been uploaded successfully.</p>
        </div>
    </div>

    <!-- Receipt Popup Modal -->
    <div id="receipt-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content document-preview">
            <div class="document-preview-container">
                <div class="document-icon">
                    <img id="receipt-category-icon" src="icons/Category-icons/default_category_icon.png" alt="Category Icon">
                </div>
                <div class="document-details">
                    <h2 id="receiptTitle" class="document-title">Document_title</h2>
                    
                    <div class="document-metadata">
                        <div class="author-badge" id="receiptAuthor">Document_Author</div>
                        <div class="category-badge" id="receiptCategory">Category</div>
                    </div>
                    
                    <div class="document-topics" id="receiptTopics">
                        <!-- Topics will be added dynamically -->
                    </div>

                    <div class="additional-info">
                        <p>Upload Date: <span id="receiptDate"></span></p>
                        <p>Volume: <span id="receiptVolume"></span></p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="close-receipt" class="close-btn">Close</button>
            </div>
        </div>
    </div>

    <script>
        fetch('./navbar_header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('navbar-header').innerHTML = data;
            })
            .catch(error => console.error('Error loading header:', error));
    </script>
    <script src="./js/side_bar.js"></script>
    <script src="./js/get-author.js"></script>
    <script src="./js/get-topics.js"></script>
    <script type="module" src="./js/upload.js"></script>
    <script src="./js/category-icon.js"></script>
</body>
</html>